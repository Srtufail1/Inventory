generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id           String   @id @default(auto()) @map("_id") @db.ObjectId
  name         String
  email        String   @unique
  password     String
  isAdmin      Boolean  @default(false)
  isSuperAdmin Boolean  @default(false)
  loginToken   String?  @default("false")
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
}

model Inward {
  id            String   @id @default(auto()) @map("_id") @db.ObjectId
  addDate       DateTime
  inumber       String
  customer      String
  item          String
  packing       String
  weight        String
  quantity      String
  store_rate    String
  labour_rate   String
  notes         String?

  @@index([customer])
  @@index([inumber])
  @@index([addDate])
}

model Outward {
  id            String   @id @default(auto()) @map("_id") @db.ObjectId
  outDate       DateTime
  onumber       String
  inumber       String
  customer      String
  item          String
  quantity      String
  notes         String?

  @@index([customer])
  @@index([inumber])
  @@index([outDate])
}

model Note {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  type        String    // "old_inward", "old_outward", "general", "memo"
  title       String
  description String
  customer    String?
  inumber     String?
  item        String?
  quantity    String?
  date        DateTime?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @updatedAt

  @@index([customer])
  @@index([type])
  @@index([inumber])
}

model AuditLog {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  action      String   // "create", "update", "delete"
  entity      String   // "inward", "outward"
  entityId    String   // ID of the affected record
  user        String   // email of the user who performed the action
  userName    String   // name of the user
  customer    String?  // customer name from the record
  inumber     String?  // inward number from the record
  onumber     String?  // outward number from the record
  item        String?  // item from the record
  quantity    String?  // quantity from the record
  changes     String?  // JSON string of old vs new values for updates
  createdAt   DateTime @default(now())

  @@index([entity])
  @@index([action])
  @@index([user])
  @@index([createdAt])
}

model ItemTranslation {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  englishName String   @unique
  urduName    String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
}
